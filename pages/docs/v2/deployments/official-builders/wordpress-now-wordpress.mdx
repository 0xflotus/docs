import Doc from '~/components/layout/docs'
import { TerminalInput } from '~/components/text/terminal'
import { Code, InlineCode } from '~/components/text/code'
import { GenericLink } from '~/components/text/link'
import { Image } from '~/components/media'
import Caption from '~/components/text/caption'
import Note from '~/components/text/note'
import Example from '~/components/example'
import Tag from '~/components/text/tag'
import Card from '~/components/card'

export const meta = {
  title: 'WordPress Builder (@now/wordpress)',
  description:
    'The official WordPress Builder for ZEIT Now. Deploy WordPress applications with ease.'
}

<Tag>Status: Beta</Tag>

The `@now/wordpress` Builder takes in a `wp-config.php` file as an entry point, installs WordPress, and outputs the result as a [Lambda](/docs/v2/deployments/concepts/lambdas).

## When to Use It

Whenever you want to quickly create a Wordpress site.

### How to use it

Define these two files within a folder like so:

- `ca.pem` - A source file that contains the database hosting CA certificate for securely connecting to a hosted MySQL database.
- `wp-config.php` - A configuration file for Wordpress.

Define the `ca.pem` source file by copying the contents of your **SSL CA certificate** from your MySQL cloud hosting provider to the file. Ensure you pick a database location that matches a Now deployment region.

Define the `wp-config.php` source file by copying the content from [this wordpress builder example config file](https://github.com/zeit/now-builders/blob/master/packages/now-wordpress/test/fixtures/20-minimal/wp-config.php) into your `wp-config.php` file.

And finally, define a `now.json` like so:

```json
{
  "version": 2,
  "builds": [{ "src": "wp-config.php", "use": "@now/wordpress" }],
  "routes": [
    { "src": "/wp-admin/?", "dest": "index.php" },
    { "src": ".*\\.php$", "dest": "index.php" }
  ],
  "env": {
    "DB_NAME": "@wordpress_db_name",
    "DB_USER": "@wordpress_db_user",
    "DB_PASSWORD": "@wordpress_db_password",
    "DB_HOST": "@wordpress_db_host"
  }
}
```

<Caption>
  A <InlineCode>now.json</InlineCode> file defining the{' '}
  <GenericLink href="/docs/v2/platform/overview#versioning">
    Now platform version
  </GenericLink>{' '}
  and a build step using the <InlineCode>@now/wordpress</InlineCode> Builder.
</Caption>

<Note>
  Don't forget to add <InlineCode>wordpress_db_name</InlineCode>,{' '}
  <InlineCode>wordpress_db_user</InlineCode>,
  <InlineCode>wordpress_db_password</InlineCode>, and{' '}
  <InlineCode>wordpress_db_host</InlineCode> as{' '}
  <GenericLink href="/docs/v2/deployments/environment-variables-and-secrets/#securing-environment-variables-using-secrets">
    secrets with Now
  </GenericLink>{' '}
  to your deployment.
</Note>

After running `now`, you'll get a URL like this: https://wordpress-8yvrab9k2.now.sh/

## Technical Details

### Entrypoint

The entrypoint file must always be a `wp-config.php` source file.

### WordPress Version

The latest version of WordPress is fetched from: https://wordpress.org/

### Maximum Lambda Bundle Size

To help keep cold boot times low, the [maximum output bundle size](/docs/v2/deployments/concepts/lambdas#maximum-bundle-size) for a Wordpress lambda is, by default, **`20mb`**.

This [limit is extendable](/docs/v2/deployments/builders/overview#configuring-output-lambda-size) up to **`50mb`**.

<Example>
  <span>
    Example <InlineCode>maxLambdaSize</InlineCode> configuration:
  </span>
  <Code lang="json">{`{
  "builds": [
    { "src": "wp-config.php", "use": "@now/wordpress", "config": { "maxLambdaSize": "25mb" } }
  ]
}`}</Code>
</Example>

## Resources

The goal of the ZEIT Docs is to provide you with all the information you need to easily deploy your projects. The following resources can also help you set up other projects:

<Card
  title="Guide: Deploy Hugo with Now"
  href="/guides/deploying-hugo-with-now/"
>
  Learn how to setup and deploy a Hugo project with Now and add caching headers
  to it.
</Card>

<Card
  title="Guide: Deploy Apollo Server with Now"
  href="/guides/deploying-apolloserver-to-now"
>
  Learn how to setup and deploy an Apollo GraphQL server with Now.
</Card>

<Card
  title="Guide: Deploy Gatsby with Now"
  href="/guides/deploying-gatsby-with-now"
>
  Setup and deploy a Gatsby project with Now with caching headers for extra
  speed.
</Card>

<Card title="Document: Builds Overview" href="/docs/v2/deployments/builds/">
  Learn all about build steps and what you can achieve with your Now-deployed
  projects.
</Card>

<Card title="Document: Deployment Overview" href="/docs/v2/deployments/basics/">
  Discover the deployment basics of Now.
</Card>

export default ({ children }) => <Doc meta={meta}>{children}</Doc>
